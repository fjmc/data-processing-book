<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="generator" content="pandoc">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title></title>
    <style type="text/css">code{white-space: pre;}</style>
    <link rel="stylesheet" href="pandoc.css">
    <!--[if lt IE 9]>
        <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
    <![endif]-->
</head>
<body>
<h1 id="module-5-information-selection-with-regular-expressions">Module 5 – Information selection with regular expressions</h1>
<h2 id="objectives">Objectives:</h2>
<ul>
<li>Develop regular expressions that represent several selection criteria</li>
<li>Use the <code>re</code> Python module to create the regular expressions</li>
<li>Search for aminoacid motives in the enzyme sequences</li>
</ul>
<h2 id="input">Input:</h2>
<ul>
<li>File <a href="files/sequences.csv">sequences.csv</a> from module 3</li>
</ul>
<h2 id="output">Output:</h2>
<ul>
<li>File: <code>relevant_sequences_1.csv</code></li>
<li>File: <code>relevant_sequences_2.csv</code></li>
<li>File: <code>relevant_sequences_3.csv</code></li>
</ul>
<h2 id="steps">Steps:</h2>
<ol type="1">
<li><p>In this module, we will search, using regular expressions, the enzymes whose aminoacid sequence matches a certain pattern.</p>
<ol type="a">
<li><p>You can consult a <a href="http://www.cheat-sheets.org/saved-copy/regular_expressions_cheat_sheet.png">reference cheat sheet of regular expressions</a>.</p></li>
<li><p>You can also find the correspondence between each aminoacid and their 1-letter code in this <a href="http://bio100.class.uic.edu/lectures/aminoacids01.jpg">chart</a>.</p></li>
<li><p>Familiarize yourself these two charts.</p></li>
</ol></li>
<li><p>We start by reading the file <code>sequences.csv</code> and creating a dictionary that associates the enzymes with their aminoacid sequence, just as we did in the previous module.</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> csv

<span class="co"># Read the CSV file</span>
f <span class="op">=</span> <span class="bu">open</span>(<span class="st">&#39;sequences.csv&#39;</span>)
enzymes <span class="op">=</span> csv.reader(f, delimiter<span class="op">=</span>???)

<span class="co"># Create an empty dictionary that we will populate as we read the CSV</span>
<span class="co"># file</span>
dict_sequences <span class="op">=</span> {}

<span class="co"># For each of the enzymes in the file, associate the enzyme with its</span>
<span class="co"># sequence</span>
<span class="cf">for</span> enzyme <span class="op">in</span> enzymes:
    enzyme_id <span class="op">=</span> enzyme[???] <span class="co"># The ID of this enzyme</span>
    seq <span class="op">=</span> enzyme[???]       <span class="co"># The aminoacid sequence of this enzyme</span>
    dict_sequences[enzyme_id] <span class="op">=</span> seq</code></pre></div></li>
<li><p>Now that we have the dictionary, let’s search for all enzymes whose aminoacid sequence contains three consecutive alanines:</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co"># We import the re module to handle regular expressions</span>
<span class="im">import</span> re

<span class="co"># Define here your regular expression</span>
reg_expr <span class="op">=</span> <span class="vs">r&#39;???&#39;</span>

<span class="co"># For each enzyme, retrieve their sequence and determine whether</span>
<span class="co"># the sequence matches three consecutive alanines</span>
<span class="cf">for</span> enzyme <span class="op">in</span> dict_sequences:
    <span class="co"># Retrieve the aminoacid sequence</span>
    seq <span class="op">=</span> ???

    <span class="co"># Determine whether the sequence matches the pattern</span>
    <span class="cf">if</span> re.search(reg_expr, seq):
        <span class="bu">print</span> <span class="st">&#39;The enzyme &#39;</span> <span class="op">+</span> ??? <span class="op">+</span> <span class="st">&#39; matches the expression &#39;</span> <span class="op">+</span> reg_expr</code></pre></div></li>
<li><p>Change the code above to save the enzyme identifiers and sequences to a file named <code>relevant_sequences_1.csv</code> instead of printing them to the screen. Refer to module 4, step 3 to refresh your memory on how to write a CSV file.</p></li>
<li><p>Change the regular expression in the Python script in order to find other sequences. For each of these patterns, save a new file named <code>relevant_sequences_2.csv</code> and <code>relevant_sequences_3.csv</code> respectively.</p>
<ol type="a">
<li><p>Sequences where the first 5 aminoacids are non-polar.</p></li>
<li><p>Sequences that contain a methionine, followed by any aminoacid, followed by either a serine or a proline.</p></li>
</ol></li>
<li><p>Run the code and take notice of the files that were created. Do they correspond to what you were expecting to see?</p></li>
<li><p>Make sure you keep a copy of the <code>relevant_sequences_1.csv</code>, <code>relevant_sequences_2.csv</code> and <code>relevant_sequences_3.csv</code> files to yourself, so that you can use them in the next modules. For example, send it to you by email or upload it to Dropbox.</p></li>
<li><p>Submit your code and the answers to the quiz below to moodle.</p></li>
</ol>
<h2 id="quiz">Quiz:</h2>
<ol type="1">
<li><p>Write an alternative regular expression to the one of step 3 having the same meaning but using different regular expression elements.</p></li>
<li><p>Imagine you want to apply the first regular expression used in this module (three consecutive alanines) to the file <code>relevant_sequences_2.csv</code> instead of <code>sequences.csv</code>. What modifications would you have to do in the Python script to accommodate this change? Would the result be the equal to what you got in <code>relevant_sequences_1.csv</code>?</p></li>
</ol>
<p><strong>Note</strong>: In case you want to explore regular expressions in more detail, we propose the following exercise:<br> What regular expression describes a molecular group that connects to GTP? This is a complex pattern that can be described with three smaller sequences (note that there is no aminoacid with the letter <code>X</code>; this letter is used to describe that any aminoacid can occur in that position):</p>
<ul>
<li>the first is <code>GXXXXGK</code>,</li>
<li>the second is <code>DXXG</code>, and</li>
<li>the third is <code>NKXD</code> or <code>NKXW</code>.</li>
</ul>
<p>The first and second group are separated by either 40 to 80 aminoacids or 130 to 170 aminoacids; the second and third groups are separated by 40 to 80 aminoacids. <small>[Source: Dever TE, Glynias MJ, Merrick WC (1987). PNAS 84(7), 1814-1818.]</small></p>
<script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
<script>

// Replace all instances of "???" inside <code> elements with the HTML code:
// <span class="blank">?</span>
$("code").html(function () {
    return $(this).html().replace(/\?\?\?/g, "<span class=\"blank\">?</span>");
});

// "print" is a builtin in python3 but a keyworkd in python2.
// Let's make sure this change happens
$("span.bu").each(function() {
    if ($(this).text() == "print") {
        $(this).removeClass('bu');
        $(this).addClass('kw');
    }
})

</script>
</body>
</html>
